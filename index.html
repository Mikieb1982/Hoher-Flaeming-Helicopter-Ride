index.html            border-radius: 10px;
            text-align: center;
            z-index: 1000;
        }
        
        #hud {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            background: rgba(0,0,0,0.5);
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
            min-width: 200px;
            z-index: 100;
        }
        
        #hud h3 {
            margin: 0 0 10px 0;
            font-size: 18px;
            color: #FFD700; /* Gold color for heading */
        }
        
        .hud-item {
            margin: 5px 0;
            display: flex;
            justify-content: space-between;
        }
        
        .hud-value {
            font-weight: bold;
            color: #00FF00; /* Green for values */
        }
        
        #controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            color: white;
            background: rgba(0,0,0,0.5);
            padding: 15px;
            border-radius: 8px;
            font-size: 12px;
            z-index: 100;
        }
        
        #controls h4 {
            margin: 0 0 8px 0;
            color: #FFD700;
        }
        
        .control-item {
            margin: 3px 0;
        }
        
        .key {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 2px 6px;
            border-radius: 3px;
            margin-right: 5px;
            font-weight: bold;
            min-width: 20px;
            text-align: center;
        }
        
        #poi-list {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            background: rgba(0,0,0,0.5);
            padding: 15px;
            border-radius: 8px;
            font-size: 12px;
            max-width: 250px;
            max-height: 400px;
            overflow-y: auto;
            z-index: 100;
        }
        
        #poi-list h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
            color: #FFD700;
        }
        
        .poi-item {
            margin: 5px 0;
            padding: 5px;
            border-radius: 3px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .poi-item:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .poi-item.visited {
            color: #00FF00; /* Green for visited POIs */
            text-decoration: line-through;
        }
        
        #message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 32px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
            background: rgba(0,0,0,0.5);
            padding: 20px 40px;
            border-radius: 10px;
            display: none;
            z-index: 500;
        }

        #info-panel {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 500px;
            max-width: 90%;
            background: rgba(255,255,255,0.95);
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: none;
            z-index: 600;
            color: #333;
        }
        
        #info-panel h2 {
            margin: 0 0 15px 0;
            color: #c94a4a;
            font-size: 24px;
        }
        
        #info-panel p {
            line-height: 1.6;
            margin: 0 0 20px 0;
            font-size: 16px;
            color: #555;
        }
        
        #info-panel button {
            background: #c94a4a;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        #info-panel button:hover {
            background: #a83a3a;
        }
    </style>
</head>
<body>
    <!-- UI Elements -->
    <div id="loader">
        <div>Loading Hoher Fläming...</div>
        <div style="margin-top: 10px; font-size: 14px;">Preparing helicopter...</div>
    </div>
    
    <div id="hud" style="display: none;">
        <h3>Flight Status</h3>
        <div class="hud-item"><span>Altitude:</span><span class="hud-value" id="altitude">0</span> m</div>
        <div class="hud-item"><span>Speed:</span><span class="hud-value" id="speed">0</span> km/h</div>
        <div class="hud-item"><span>Heading:</span><span class="hud-value" id="heading">N</span></div>
        <div class="hud-item"><span>POIs Visited:</span><span class="hud-value"><span id="visited">0</span>/16</span></div>
    </div>
    
    <div id="controls" style="display: none;">
        <h4>Controls</h4>
        <div class="control-item"><span class="key">↑</span> Forward</div>
        <div class="control-item"><span class="key">↓</span> Backward</div>
        <div class="control-item"><span class="key">←</span> Turn Left</div>
        <div class="control-item"><span class="key">→</span> Turn Right</div>
        <div class="control-item"><span class="key">Space</span> Ascend</div>
        <div class="control-item"><span class="key">Shift</span> Descend</div>
        <div class="control-item"><span class="key">L</span> Land at POI</div>
        <div class="control-item"><span class="key">Mouse</span> Look Around</div>
    </div>
    
    <div id="poi-list" style="display: none;">
        <h3>Points of Interest</h3>
        <div id="poi-items"></div>
    </div>
    
    <div id="message"></div>
    
    <div id="info-panel">
        <h2 id="info-title"></h2>
        <p id="info-description"></p>
        <button onclick="closeInfoPanel()">Continue Flying</button>
    </div>

    <script>
        // Main game script
        try {
            // ============= CONFIGURATION =============
            const CONFIG = {
                MOVEMENT_SPEED: 30,
                TURN_SPEED: 1.5,
                CLIMB_SPEED: 20,
                CAMERA_DISTANCE: 30,
                CAMERA_HEIGHT: 15,
                LANDING_DISTANCE: 15, // Increased landing distance
                LANDING_HEIGHT: 5,
                MAP_SIZE: 500
            };

            let gamePaused = false;

            // ============= POI DATA =============
            const POI_DATA = [
                { id: 1, name: "Stadt und Burg Ziesar", x: -180, z: -190, visited: false, description: "Auf der Burg Ziesar befindet sich das Museum für brandenburgische Kirchen- und Kulturgeschichte des Mittelalters. Der sehr gut erhaltene Burgfried und die Schlosskapelle bieten einen weiten Blick über den Ziesarer Kiez." },
                { id: 2, name: "Gutspark Dahlen", x: -80, z: -150, visited: false, description: "Der Gutspark Dahlen ist ein Waldstück seltener botanischer Kunst. Spaziergänge um den Schwanensee verzaubern die Besucher. Der Bauerngarten mit Kultur- und Duftpflanzen kann besucht werden." },
                { id: 3, name: "Klein Briesener Bach", x: 20, z: -170, visited: false, description: "Der Artesische Brunnen im Naturschutzgebiet Klein Briesener Bach - hier steigt das Wasser nur durch den Erd-Eigendruck hervor und wird durch eine Rinne dem Briesenfließ zugeführt." },
                { id: 4, name: "Paradies Dippmannsdorf", x: 140, z: -160, visited: false, description: "Aus einigen Dutzend Quellen sprudelt glasklares Wasser, das die Mühlenbäche speist. Der aus Buchen, Eichen und Birken bestehende Quellkopf wurde begehbar erschlossen." },
                { id: 5, name: "Töpferort Görzke", x: -185, z: -80, visited: false, description: "Ein Besuch der kleinen Museen und des Handwerkerhofs, ein Bummel entlang der Bauernhöfe und Einkaufsmöglichkeiten in fünf Töpfereien erwarten die Besucher des Flämingdorfes." },
                { id: 6, name: "Hagelberg", x: 15, z: -20, visited: false, description: "Der Hagelberg, ein echter 'Zweitausender' (200,3m), lädt zum Eintrag ins Gipfelbuch ein. Für den 'Aufstieg' zum Gipfelkreuz wird man mit einem schönen Blick über die Fläminglandschaft belohnt." },
                { id: 7, name: "Bad Belzig mit Burg Eisenhardt", x: 145, z: -50, visited: false, description: "Auf der komplett erhaltenen Burg kann die 1000-jährige Geschichte der Stadt hautnah erkundet werden. Vom Butterturm bietet sich der schönste Ausblick auf Stadt und Urstromtal." },
                { id: 8, name: "Aussichtspunkt Belziger Landschaftswiesen", x: 200, z: -70, visited: false, description: "Am Burgenwanderweg gelegen, bietet sich ein eindrucksvoller Blick in das Niederungsgebiet - eines der wichtigsten Vogelschutzgebiete Brandenburgs mit Großtrappen." },
                { id: 9, name: "Wiesenburg mit Schloss und Park", x: -85, z: 20, visited: false, description: "Das Schloss erhebt sich majestätisch über dem Ort. Der als Landschaftspark gestaltete Schlosspark ist der bedeutendste seiner Art im Hohen Fläming und lädt zum ausgiebigen Spazieren ein." },
                { id: 10, name: "Naturparkzentrum Hoher Fläming", x: 40, z: 150, visited: false, description: "Das Besucherinformationszentrum ist zentrale Anlaufstelle für alle Gäste. Hier erhält man die besten Tipps für Ausflüge, kann Fahrräder ausleihen und die Naturparkausstellung besuchen." },
                { id: 11, name: "Raben mit Burg Rabenstein", x: 30, z: 140, visited: false, description: "Auf einem Hügel gelegen thront die südlichste der Flämingburgen, die Burg Rabenstein. Von hier führt ein Naturlehrpfad durch das Naturschutzgebiet Rabenstein hinunter ins Dorf." },
                { id: 12, name: "Niemegk", x: 210, z: 70, visited: false, description: "Das Städtchen Niemegk mit seinem alten Rathaus prägt das Stadtbild. Vom Kirchturm bietet sich ein schöner Ausblick auf die Hauptkette des Flämings." },
                { id: 13, name: "Flämingbuchen", x: -140, z: 90, visited: false, description: "In dem großen Waldgebiet der Brandenheide sind einige Inseln aus Buchen zu finden, wie in den Naturschutzgebieten 'Flämingbuchen' und 'Spring'." },
                { id: 14, name: "Brautrummel mit Riesenstein", x: 25, z: 35, visited: false, description: "Die Sage erzählt, wie ein junges Brautpaar nach einem Gewitterregen in der Rummel ertrank. Heute kann man auf einer Rundwanderung zum Riesenstein die besondere Natur erleben." },
                { id: 15, name: "Neuendorfer Rummel", x: 150, z: 140, visited: false, description: "Die Rummeln - verzweigte, enge Trockentäler - entstanden nach dem Abtauen der Gletscher. Wie grüne Finger stechen sie sich weit in die Agrarlandschaft hinein." },
                { id: 16, name: "Garrey mit Aussichtsplattform", x: 180, z: 160, visited: false, description: "Die Landschaft rings um Garrey bietet fantastische Ausblicke. Eine Aussichtsplattform krönt das restaurierte alte Wasserwerk, in dem sich eine kleine Ausstellung befindet." }
            ];

            // ============= GAME STATE =============
            const gameState = {
                keys: {},
                mouseDown: false,
                mouseX: 0,
                mouseY: 0,
                velocity: new THREE.Vector3(),
                angularVelocity: 0,
                altitude: 10,
                speed: 0,
                heading: 0,
                visitedCount: 0,
                nearPOI: null
            };

            // ============= SCENE SETUP =============
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 2000);
            const renderer = new THREE.WebGLRenderer({ antialias: true, powerPreference: "high-performance" });
            
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            document.body.appendChild(renderer.domElement);

            // ============= LIGHTING =============
            scene.add(new THREE.AmbientLight(0xffffff, 0.6));
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(100, 100, 50);
            directionalLight.castShadow = true;
            directionalLight.shadow.camera.left = -CONFIG.MAP_SIZE / 2;
            directionalLight.shadow.camera.right = CONFIG.MAP_SIZE / 2;
            directionalLight.shadow.camera.top = CONFIG.MAP_SIZE / 2;
            directionalLight.shadow.camera.bottom = -CONFIG.MAP_SIZE / 2;
            scene.add(directionalLight);

            // ============= SKY & SUN =============
            const sky = new THREE.Mesh(
                new THREE.SphereGeometry(1000, 32, 32),
                new THREE.MeshBasicMaterial({ color: 0x87CEEB, side: THREE.BackSide })
            );
            scene.add(sky);
            
            const sun = new THREE.Mesh(
                new THREE.SphereGeometry(20, 16, 16),
                new THREE.MeshBasicMaterial({ color: 0xffff99 })
            );
            sun.position.copy(directionalLight.position);
            scene.add(sun);

            // ============= TERRAIN =============
            const terrainGeometry = new THREE.PlaneGeometry(CONFIG.MAP_SIZE, CONFIG.MAP_SIZE, 100, 100);
            const vertices = terrainGeometry.attributes.position.array;
            for (let i = 0; i < vertices.length; i += 3) {
                const x = vertices[i];
                const y = vertices[i + 1];
                // Simple noise for hills
                vertices[i + 2] = (Math.sin(x * 0.02) + Math.cos(y * 0.03)) * 5 + Math.random() * 2;
            }
            terrainGeometry.computeVertexNormals();
            
            const terrainMaterial = new THREE.MeshLambertMaterial({ color: 0x3a8b3a });
            const terrain = new THREE.Mesh(terrainGeometry, terrainMaterial);
            terrain.rotation.x = -Math.PI / 2; // This line was incomplete
            terrain.receiveShadow = true;
            scene.add(terrain);

            // ============= HELICOPTER =============
            const helicopter = new THREE.Group();
            const bodyMat = new THREE.MeshPhongMaterial({ color: 0x4287f5 }); // Blue body
            const glassMat = new THREE.MeshPhongMaterial({ color: 0xadd8e6, transparent: true, opacity: 0.5 });
            
            const body = new THREE.Mesh(new THREE.BoxGeometry(10, 4, 5), bodyMat);
            helicopter.add(body);

            const cockpit = new THREE.Mesh(new THREE.SphereGeometry(3, 8, 8), glassMat);
            cockpit.position.x = 5;
            helicopter.add(cockpit);

            const tailBoom = new THREE.Mesh(new THREE.CylinderGeometry(0.5, 0.5, 8, 8), bodyMat);
            tailBoom.rotation.z = Math.PI / 2;
            tailBoom.position.x = -9;
            helicopter.add(tailBoom);
            
            const tailRotor = new THREE.Mesh(new THREE.BoxGeometry(0.2, 2, 0.2), bodyMat);
            tailRotor.position.set(-13, 1, 0);
            helicopter.add(tailRotor);

            const mainRotor = new THREE.Mesh(new THREE.BoxGeometry(12, 0.2, 0.2), bodyMat);
            mainRotor.position.y = 3;
            helicopter.add(mainRotor);

            helicopter.position.y = gameState.altitude;
            helicopter.castShadow = true;
            scene.add(helicopter);

            // ============= POI MARKERS =============
            const poiMarkers = new THREE.Group();
            const poiMaterial = new THREE.MeshBasicMaterial({ color: 0xffa500 }); // Orange marker
            const poiGeometry = new THREE.ConeGeometry(2, 8, 8);
            
            POI_DATA.forEach(poi => {
                const marker = new THREE.Mesh(poiGeometry, poiMaterial);
                marker.position.set(poi.x, 10, poi.z); // Elevated marker
                marker.rotation.x = Math.PI; // Point down
                poi.object = marker; // Link object back to data
                poiMarkers.add(marker);
            });
            scene.add(poiMarkers);

            // ============= UI FUNCTIONS =============
            function updatePoiList() {
                const list = document.getElementById('poi-items');
                list.innerHTML = '';
                POI_DATA.forEach(poi => {
                    const item = document.createElement('div');
                    item.className = 'poi-item';
                    if (poi.visited) item.classList.add('visited');
                    item.textContent = poi.name;
                    item.onclick = () => {
                        // Fly towards POI (simple implementation)
                        helicopter.position.x = poi.x;
                        helicopter.position.z = poi.z;
                    };
                    list.appendChild(item);
                });
            }

            function showMessage(text, duration = 2000) {
                const msgEl = document.getElementById('message');
                msgEl.textContent = text;
                msgEl.style.display = 'block';
                setTimeout(() => msgEl.style.display = 'none', duration);
            }

            function openInfoPanel(poi) {
                gamePaused = true;
                document.getElementById('info-title').textContent = poi.name;
                document.getElementById('info-description').textContent = poi.description;
                document.getElementById('info-panel').style.display = 'block';
            }

            window.closeInfoPanel = function() {
                gamePaused = false;
                document.getElementById('info-panel').style.display = 'none';
            }

            // ============= INPUT HANDLING =============
            document.addEventListener('keydown', (e) => gameState.keys[e.code] = true);
            document.addEventListener('keyup', (e) => gameState.keys[e.code] = false);
            
            // ============= ANIMATION LOOP =============
            const clock = new THREE.Clock();
            function animate() {
                requestAnimationFrame(animate);
                const delta = clock.getDelta();

                if (gamePaused) return;

                // --- Helicopter Logic ---
                const forward = new THREE.Vector3();
                helicopter.getWorldDirection(forward);

                if (gameState.keys['ArrowUp']) gameState.velocity.add(forward.multiplyScalar(CONFIG.MOVEMENT_SPEED * delta));
                if (gameState.keys['ArrowDown']) gameState.velocity.sub(forward.multiplyScalar(CONFIG.MOVEMENT_SPEED * delta));
                if (gameState.keys['ArrowLeft']) helicopter.rotation.y += CONFIG.TURN_SPEED * delta;
                if (gameState.keys['ArrowRight']) helicopter.rotation.y -= CONFIG.TURN_SPEED * delta;
                if (gameState.keys['Space']) helicopter.position.y += CONFIG.CLIMB_SPEED * delta;
                if (gameState.keys['Shift']) helicopter.position.y -= CONFIG.CLIMB_SPEED * delta;

                // Apply friction
                gameState.velocity.multiplyScalar(1 - 2 * delta);
                helicopter.position.add(gameState.velocity.clone().multiplyScalar(delta));
                
                // Keep helicopter within bounds
                helicopter.position.x = Math.max(-CONFIG.MAP_SIZE/2, Math.min(CONFIG.MAP_SIZE/2, helicopter.position.x));
                helicopter.position.z = Math.max(-CONFIG.MAP_SIZE/2, Math.min(CONFIG.MAP_SIZE/2, helicopter.position.z));
                helicopter.position.y = Math.max(2, helicopter.position.y); // Min altitude

                // Rotor animation
                mainRotor.rotation.y += 20 * delta;
                tailRotor.rotation.x += 20 * delta;

                // --- Camera Logic ---
                const idealOffset = new THREE.Vector3(-CONFIG.CAMERA_DISTANCE, CONFIG.CAMERA_HEIGHT, 0);
                idealOffset.applyQuaternion(helicopter.quaternion);
                const idealLookat = helicopter.position.clone();
                
                const cameraPosition = helicopter.position.clone().add(idealOffset);
                camera.position.lerp(cameraPosition, 0.1);
                camera.lookAt(idealLookat);

                // --- POI Logic ---
                let closestPOI = null;
                let minDist = CONFIG.LANDING_DISTANCE;
                
                POI_DATA.forEach(poi => {
                    const dist = helicopter.position.distanceTo(poi.object.position);
                    if (dist < minDist) {
                        minDist = dist;
                        closestPOI = poi;
                    }
                    // Marker animation
                    poi.object.rotation.y += 0.5 * delta;
                });
                gameState.nearPOI = closestPOI;

                if (gameState.keys['KeyL'] && gameState.nearPOI && !gameState.nearPOI.visited) {
                    if (helicopter.position.y < CONFIG.LANDING_HEIGHT) {
                        gameState.nearPOI.visited = true;
                        gameState.visitedCount++;
                        updatePoiList();
                        openInfoPanel(gameState.nearPOI);
                    } else {
                        showMessage("Too high to land! Descend below 5m.");
                    }
                }

                // --- Update HUD ---
                document.getElementById('altitude').textContent = helicopter.position.y.toFixed(0);
                document.getElementById('speed').textContent = (gameState.velocity.length() * 3.6).toFixed(0); // Convert m/s to km/h
                document.getElementById('visited').textContent = gameState.visitedCount;
                const heading = (helicopter.rotation.y * 180 / Math.PI) % 360;
                const directions = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'];
                document.getElementById('heading').textContent = directions[Math.round(((heading < 0 ? 360 + heading : heading) / 45)) % 8];

                renderer.render(scene, camera);
            }

            // --- Initialisation ---
            document.getElementById('loader').style.display = 'none';
            document.getElementById('hud').style.display = 'block';
            document.getElementById('controls').style.display = 'block';
            document.getElementById('poi-list').style.display = 'block';
            updatePoiList();
            animate();

        } catch (e) {
            console.error('An error occurred:', e);
            const loader = document.getElementById('loader');
            if(loader) loader.innerHTML = '<div>A critical error occurred. Please check the console (F12) and refresh.</div>';
        }
    </script>
</body>
</html>

